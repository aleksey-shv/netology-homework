# Домашнее задание к занятию "`12.7 «Репликация и масштабирование. Часть 2»`" - `Шведов Алексей`

---

### Задание 1

Опишите основные преимущества использования масштабирования методами:  
активный master-сервер и пассивный репликационный slave-сервер;  
master-сервер и несколько slave-серверов;  
активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);  
SAN-кластер.  
Дайте ответ в свободной форме.

### Ответ:

**Активный master-сервер и пассивный репликационный slave-сервер:**  

Одним из основных преимуществ такой системы является повышение отказоустойчивости и надежности данных. Активный master-сервер является основным источником записи данных, что позволяет обеспечить быструю и надежную запись информации. Пассивный репликационный slave-сервер, в свою очередь, представляет собой резервный узел, который автоматически получает копию данных от master-сервера. Это обеспечивает резервное копирование и увеличивает доступность данных в случае отказа основного сервера. Такой подход позволяет снизить риск потери данных и обеспечивает меньшие периоды простоя в случае сбоя.  

**Master-сервер и несколько slave-серверов:**    

Использование нескольких slave-серверов повышает масштабируемость и производительность системы. Master-сервер отвечает за запись данных и координирует работу slave-серверов, которые обрабатывают запросы на чтение. Этот подход позволяет балансировать нагрузку между серверами и обеспечивает более высокую производительность при обработке множества запросов от клиентов. Кроме того, такая архитектура улучшает отказоустойчивость, так как при выходе из строя одного из slave-серверов система продолжает функционировать, переключая обработку запросов на оставшиеся серверы.  

**Активный сервер со специальным механизмом репликации — distributed replicated block device (DRBD):**  

DRBD - это технология блочного уровня репликации данных между серверами. Основным преимуществом этого подхода является высокая степень отказоустойчивости и надежности. Когда данные записываются на активный сервер, они автоматически реплицируются на пассивный сервер. Это обеспечивает высокую доступность данных и минимальное время восстановления в случае сбоя. DRBD также позволяет использовать различные технологии файловой системы и приложения без необходимости изменений в существующих приложениях.  

**SAN-кластер:**  

SAN-кластер представляет собой сеть хранилищ с общим доступом к данным для нескольких серверов. Главным преимуществом SAN-кластера является возможность распределения данных и ресурсов между узлами кластера. Это позволяет увеличить производительность, масштабируемость и отказоустойчивость системы. Кластеризация также обеспечивает высокую доступность данных и возможность балансировки нагрузки между узлами, что улучшает общую производительность системы. Кроме того, SAN-кластер позволяет более гибко управлять хранилищем и обеспечивает удобство расширения системы при необходимости.  

Итак, выбор конкретной архитектуры зависит от требований к системе, ее целей, бюджета и других факторов. Каждая из описанных архитектур имеет свои преимущества, и правильное решение будет определяться особенностями конкретного проекта или бизнеса.

---

### Задание 2

Разработайте план для выполнения горизонтального и вертикального шардинга базы данных.  
База данных состоит из трёх таблиц:  
пользователи,  
книги,  
магазины (столбцы произвольно).  
Опишите принципы построения системы и их разграничение или разбивку между базами данных.  
Пришлите блоксхему, где и что будет располагаться. Опишите, в каких режимах будут работать сервера.

### Ответ:

Горизонтальный и вертикальный шардинг являются стратегиями разделения баз данных для обеспечения масштабируемости и повышения производительности системы. В данном случае, у нас есть база данных с тремя таблицами: пользователи, книги и магазины. Рассмотрим, как можно применить горизонтальный и вертикальный шардинг для каждой таблицы.  

**Пользователи (Users) таблица:**  

Горизонтальный шардинг может быть применен на основе критерия, который помогает распределить пользователей по разным базам данных. Например, можно разделить пользователей по регионам, странам или алфавитным интервалам фамилий. Каждая база данных будет содержать пользователей, удовлетворяющих определенному критерию.  

Вертикальный шардинг может быть использован для разделения таблицы "пользователи" на две или более баз данных на основе их использования. Одна база данных будет содержать общую информацию о пользователях, такую как идентификатор, имя, электронная почта и т.д. Другая база данных может содержать более чувствительные данные, такие как пароли, история покупок или личная информация.  

**Книги (Books) таблица:**  

Горизонтальный шардинг может быть применен, например, на основе жанров или категорий книг. Таким образом, все книги определенного жанра будут храниться в одной базе данных.  

Вертикальный шардинг может быть использован, чтобы разделить таблицу "книги" на две или более базы данных. Одна база данных может содержать основную информацию о книгах, такую как название, автор и издательство. Другая база данных может содержать дополнительную информацию, такую как отзывы пользователей, статистика продаж и т.д.  

**Магазины (Shops) таблица:**  

Горизонтальный шардинг может быть применен на основе расположения магазинов (например, город или регион), чтобы магазины из одного региона хранились в одной базе данных.  

Вертикальный шардинг может быть использован для разделения таблицы "магазины" на две или более базы данных. Одна база данных может содержать общую информацию о магазинах, такую как название, адрес и контактные данные. Другая база данных может содержать информацию о запасах товаров, ценах и т.д.  

```
+--------------------+
|  Приложение/Клиент |
+--------|-----------+
         | Запросы
         V
+-------------------------+
|     Балансировщик      |
+---------|---------------+
          | Распределение запросов
          V
+-------------+     +-------------+     +-------------+
|  Сервер 1  |     |  Сервер 2  |     |  Сервер 3  |
|  (Users)   |     |   (Books)  |     |  (Shops)   |
+-------------+     +-------------+     +-------------+
     |                    |                   |
     |                    |                   |
     |                    |                   |
     V                    V                   V
+------------------------------------------------------+
|            Горизонтальный и вертикальный шардинг        |
+------------------------------------------------------+
     |                    |                   |
     |                    |                   |
     |                    |                   |
     V                    V                   V
+-------------+     +-------------+     +-------------+
|   БД 1      |     |   БД 2      |     |   БД 3      |
|  (Users)   |     |   (Books)   |     |   (Shops)   |
+-------------+     +-------------+     +-------------+
     |                    |                   |
     |                    |                   |
     |                    |                   |
     V                    V                   V
+------------------------------------------------------+
|          Разделение данных внутри каждой БД          |
+------------------------------------------------------+
```

**В этой блоксхеме:**  

Приложение/Клиент отправляет запросы к Базе данных через балансировщик, который распределяет запросы между серверами с учетом определенных правил и настроек нагрузки.  

Существует три сервера: Сервер 1 (для таблицы пользователей - Users), Сервер 2 (для таблицы книг - Books) и Сервер 3 (для таблицы магазинов - Shops). Каждый сервер хранит данные определенной таблицы.  

Горизонтальный и вертикальный шардинг применяются на уровне серверов. Например, Сервер 1 может использовать горизонтальный шардинг для разделения пользователей по регионам, а вертикальный шардинг для разделения чувствительных данных пользователей.  

Каждый сервер имеет свою собственную базу данных (БД 1, БД 2, БД 3), где хранятся данные относящиеся к конкретной таблице.  

Внутри каждой БД происходит разделение данных на основе определенных критериев, которые позволяют эффективно организовать данные и облегчить доступ к ним.  

Каждый сервер работает в соответствующем режиме горизонтального и/или вертикального шардинга, что позволяет увеличить производительность системы и обеспечить масштабируемость.  

Таким образом, блоксхема демонстрирует общую структуру системы с горизонтальным и вертикальным шардингом базы данных, а также показывает, как данные разделяются и хранятся на различных серверах для обеспечения оптимальной производительности и доступности.  

**Режимы работы серверов:**  

Режим горизонтального шардинга:  
Каждый сервер содержит часть данных, определенных по критериям (например, регионы, жанры или категории).
Вертикальное разбиение таблицы может также применяться одновременно.  

Режим вертикального шардинга:  
Каждый сервер содержит разные столбцы той же таблицы, чтобы распределить данные так, чтобы часть была менее доступной или содержала более чувствительные данные.  

Комбинированный режим:  
Возможно, применение обоих видов шардинга, чтобы добиться наилучшей производительности и масштабируемости.  

При выборе подхода к шардингу необходимо учитывать запросы и потребности приложения, а также распределение нагрузки на серверы, чтобы достичь оптимальной производительности системы. Кроме того, важно обеспечить согласованность данных между базами данных и учесть возможные проблемы, связанные с распределенной природой системы.

---

